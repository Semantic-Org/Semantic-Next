---
import Layout from '@layouts/Layout.astro';
import { each } from '@semantic-ui/utils';
import './Guide.css';

const getRailMenu = (headings) => {
	let menu = [];
	let items = [];
	let menuGroup;
	each(Astro.props.headings, heading => {
		// new grouping
		if(heading.depth <= 2) {
			if(menuGroup) {
				menu.push(menuGroup);
			}
			menuGroup = {
				_id: heading.slug,
				title: heading.text,
				items: []
			}
		}
		else if(menuGroup) {
			// submenu
			menuGroup.items.push({
				_id: heading.slug,
				title: heading.text
			});
		}
	});
	menu.push(menuGroup);
	return menu;
};
const { frontmatter } = Astro.props;

const railMenu = getRailMenu(Astro.props.heading);
---
<Layout
	inlineHeader=true
	header={frontmatter.title}
	headerIcon={frontmatter.icon}
	headerImage={frontmatter.iconImage}
	scrollOffset=90
	expandRailMenu=true
	textContent=true
	railMenu={railMenu}
>
	<slot />
</Layout>
